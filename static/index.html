<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>CompHDL demo</title>
        <style>
            body {
                background-color: #eee;
            }
            input {
                font-family: monospace;
            }
            textarea {
                font-family: monospace;
            }
            .code {
                width: 95%;
            }
            #container {
              display: flex;
              flex-direction: row;
              flex-wrap: wrap;
            }
            .div-1, .div-3 {
              flex: 1 1 0;
            }
            .div-2 {
               flex: 0 0 100%;
               order: 3;
               overflow-x: auto;
            }
            #draggableControls {
                /* position: absolute; */
                border: 1px solid #343434;
                padding: 8px;
                background-color: #bbbbbb;
            }
            #draggableControlsheader {
                cursor: move;
                padding: 10px;
            }
            .noselect {
              -webkit-touch-callout: none; /* iOS Safari */
                -webkit-user-select: none; /* Safari */
                 -khtml-user-select: none; /* Konqueror HTML */
                   -moz-user-select: none; /* Firefox */
                    -ms-user-select: none; /* Internet Explorer/Edge */
                        user-select: none; /* Non-prefixed version, currently
                                              supported by Chrome and Opera */
            }
        </style>
        <style id="wire_style"></style>
        <link rel="stylesheet" href="xtermjs/xterm.css" />
    </head>
    <body>
        <div id="loading_wasm" style="display: block; color: #F00;">
            WARNING: LOADING WASM... (if this message persists for a long time,
            check if your browser supports WASM and disable any adblockers)
        </div>
        <div id="loaded_wasm" style="display: none; color: #0F0;">
            WASM MODULE SUCCESSFULLY LOADED
        </div>
        <div id="container">
        <div class="div-1">
            <div>
              <button id=loadExampleButton onClick="loadExampleSelect()">LOAD EXAMPLE:</button>
              <select id=exampleName></select>
              <button id=shareCode onClick="shareCode()">SHARE LINK</button>
            </div>
            <div id=shareCodeDiv style="display: none;">
              Manually copy the following link:
              <a href="#" onClick="document.getElementById('shareCodeDiv').style.display='none'; return false;">(hide)</a>
              <br>
              <input type="text" id="shareCodeLink" style="width: 95%;"></input>
            </div>
            <div>
              <input type="text" id="top_name" placeholder="Top component name"></input>
              <button id="comphdl_start" onClick="runGui()">RUN!</button>
            </div>
                <div id="simulation_controls" style="display: none;">
            <div id="draggableControls">
                <small id="draggableControlsheader" style="background-color: #55a;">Make this floating and move it:</small>
                <button onClick="toggleFloatingControls()">TOGGLE FLOATING</button>
                  <div>
                    Tick:
                    <input type="text" id="tick_display" size="7">
                    Ticks per second:
                    <input type="text" id="target_ticks_per_second" size="4" value="30">
                    <input type="checkbox" id="check_run_step"> running step
                    <input type="checkbox" id="check_run_forever"> running forever
                    <input type="checkbox" id="check_alive"> rust alive
                    <input type="checkbox" id="check_show_debug"> show debug
                    <input type="checkbox" id="check_show_signals" checked> show signals as colors in netlist
                    <input type="checkbox" id="check_monitor_signals" checked> monitor signals as WaveJSON
                    <input type="checkbox" id="check_render_wavedrom"> auto-render wave
                  </div>
                  <div>
                    <button id="pause_simulation" onClick="pauseSimulation()">PAUSE</button>
                    <button id="run_step" onClick="runStep()">ONE STEP</button>
                    <button id="run_forever" onClick="resumeSimulation()">RESUME</button>
                    <button id="stop_simulation" onClick="stopSimulation()">STOP</button>
                  </div>
                <div id="top_input"></div>
                <div id="top_output"></div>
                </div>
            </div>
            <div>
              <div id="comphdl_definition" style="height:500px; margin-right: 8px; margin-bottom: 16px; margin-top: 8px;"></div>
            </div>
            TABS:
            <button onClick="terminalTab(0)">HIDE TERMINAL</button>
            <button onClick="terminalTab(1)">COMPONENT STDOUT</button>
            <button onClick="terminalTab(2)">DEBUG LOGS</button>
            <div id="terminal_1" style="margin-right: 8px;"></div>
            <div id="terminal_2" style="margin-right: 8px;"></div>
        </div>
        <div class="div-3">
            <div id="statsDiv"></div>
            DEBUG OUTPUT:
            <textarea id="top_output_debug" style="height:400px; width:95%" placeholder="Simulation output" readonly></textarea>
            NETLIST JSON:
            <textarea id="comphdl_json" style="height:100px; width:95%" placeholder="Netlist json"></textarea>
            <div>
                <div style=display:flex;justify-content:space-between>
                    <button id=formatButton>Format JSON</button>
                    <div>
                        <label for=skinSelect>Select skin:</label>
                        <select id=skinSelect></select>
                        <button id=renderButton>Render</button>
                    </div>
                </div>
            </div>
            STDIN:
            <textarea id="stdin_bufread" style="height:100px; width:95%" placeholder="Stdin input"></textarea>
            STDOUT:
            <textarea id="stdout_bufwrite" style="height:100px; width:95%" placeholder="Characters written to stdout will appear here" readonly></textarea>
            WAVEJSON:
            <div id='TXT'><textarea id="InputJSON_0"></textarea></div>
            <button id="refresh_wavedrom" onClick="refreshWaveDrom()">RENDER</button>
        </div>
        <div id="bottomDiv" class="div-2 noselect">
            <div id='SVG' style="overflow:scroll;"><div id="WaveDrom_Display_0"></div></div>
            <div id="viewerContainer">
                <svg id="svgArea">
                </svg>
            </div>
        </div>
        </div>
        <script src="ace-builds/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
        <script>
            var editor = ace.edit("comphdl_definition");
            editor.setTheme("ace/theme/tomorrow");
            editor.session.setMode("ace/mode/rust");
        </script>
        <script src="stats.min.js"></script>
        <script src="comphdl.js"></script>
        <script src="elk.bundled.js"></script>
        <script src="netlistsvg.js"></script>
        <script src="http://wavedrom.com/skins/narrow.js" type="text/javascript"></script>
        <script src="http://wavedrom.com/wavedrom.min.js" type="text/javascript"></script>
        <script src="xtermjs/xterm.js"></script>
        <script>
        </script>
        <script src="index.js"></script>
    </body>
</html>
